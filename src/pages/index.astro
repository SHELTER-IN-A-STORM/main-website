---
import Layout from '../layouts/Layout.astro';
import { siteConfig } from '../config/site';
import RequestForm from '../components/RequestForm.astro';
import PartnersSection from '../components/PartnersSection.astro';
import Button from '../components/Button.astro';
---

<Layout title="Home">
    <!-- Hero Section -->
    <section class="relative min-h-[100dvh] w-full flex items-center justify-center">
        <div class="absolute inset-0">
            <img 
                src={siteConfig.metadata.openGraph.image}
                alt="Hero Background"
                class="w-full h-full object-cover object-center"
            />
            <div class="absolute inset-0 bg-gradient-to-b from-black/70 via-black/50 to-black/70"></div>
        </div>

        <div class="relative w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 z-10">
            <div class="max-w-4xl mx-auto text-center text-white space-y-8">
                <h1 
                    class="text-4xl sm:text-5xl md:text-7xl font-bold mb-6 animate-fade-in px-4"
                    style="text-wrap: balance;"
                >
                    {siteConfig.shelter.hero.title}
                </h1>
                <p 
                    class="text-lg sm:text-xl md:text-2xl text-gray-200 mb-12 animate-slide-up-delay-1 px-4"
                    style="text-wrap: balance;"
                >
                    {siteConfig.shelter.hero.subtitle}
                </p>
                <div class="flex flex-col sm:flex-row flex-wrap gap-4 justify-center animate-slide-up-delay-2 px-4">
                    {siteConfig.shelter.hero.cta.map(button => (
                        <Button
                            href={button.href}
                            class={`w-full sm:w-auto px-8 py-4 rounded-lg font-medium transition-colors ${
                                button.primary ? 'bg-brand hover:bg-brand-dark text-white' : 'bg-white/10 hover:bg-white/20 text-white'
                            }`}
                        >
                            {button.text}
                        </Button>
                    ))}
                </div>
            </div>
        </div>

        <!-- Scroll Indicator -->
        <div class="absolute bottom-12 left-1/2 transform -translate-x-1/2">
            <a 
                href="#mission" 
                class="text-white/80 hover:text-white transition-colors duration-300 animate-float"
                aria-label="Scroll to mission"
            >
                <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path 
                        stroke-linecap="round" 
                        stroke-linejoin="round" 
                        stroke-width="2" 
                        d="M19 14l-7 7m0 0l-7-7m7 7V3"
                    />
                </svg>
            </a>
        </div>
    </section>

    <!-- Mission Section -->
    <section id="mission" class="relative py-20 bg-gradient-to-b from-white to-gray-50">
        <div class="container mx-auto px-6">
            <div class="max-w-7xl mx-auto grid md:grid-cols-2 gap-12 items-center">
                <div class="space-y-6">
                    <div class="inline-flex items-center gap-2 text-brand font-medium">
                        <span class="w-12 h-[2px] bg-brand"></span>
                        <span>Our Story</span>
                    </div>
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-900 leading-tight">
                        A simple act of kindness sparked a movement
                    </h2>
                    <p class="text-gray-600 leading-relaxed">
                        What began as offering shelter from the cold to a single individual during a Bible study has grown 
                        into a dedicated mission to serve our Lake Ozark community. Today, we provide 24/7 emergency food assistance 
                        and connect those in need with vital resources.
                    </p>
                    <div class="pt-4">
                        <Button href="/about" variant="primary" size="sm">
                            <span class="font-medium">Learn More About Us</span>
                            <svg class="w-5 h-5 ml-2 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                            </svg>
                        </Button>
                    </div>
                </div>
                <div class="relative">
                    <div class="absolute inset-0 bg-brand/10 rounded-3xl transform rotate-3 transition-transform group-hover:rotate-6"></div>
                    <img 
                        src="https://images.squarespace-cdn.com/content/v1/53c68a2de4b0929c16dd9bf2/1623779915649-KOGVC81NLQDLR632328M/ribbon-cutting+photo+best.jpg?format=2500w" 
                        alt="Community Support" 
                        class="relative rounded-3xl shadow-lg object-cover w-full aspect-[4/3]"
                    />
                </div>
            </div>
        </div>
    </section>

    <!-- Services Section -->
    <section id="services" class="py-24 bg-gradient-to-b from-white to-gray-50">
        <div class="container mx-auto px-6">
            <div class="max-w-7xl mx-auto">
                <div class="space-y-6 mb-16">
                    <div class="inline-flex items-center gap-2 text-brand font-medium">
                        <span class="w-12 h-[2px] bg-brand"></span>
                        <span>How We Help</span>
                    </div>
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-900 leading-tight">Services Available 24/7</h2>
                    <p class="text-gray-600 leading-relaxed max-w-2xl">
                        Access our emergency services anytime, day or night. We're here when you need us most.
                    </p>
                </div>
                <div class="grid md:grid-cols-2 gap-8">
                    {siteConfig.shelter.services.map((service, index) => (
                        <a 
                            href={service.link} 
                            class="group relative bg-white rounded-3xl overflow-hidden shadow-lg hover:shadow-xl transition-all duration-300 flex flex-col border border-gray-100 hover:-translate-y-1"
                        >
                            <div class="relative h-[250px] overflow-hidden">
                                <img 
                                    src={service.image}
                                    alt={service.title}
                                    class="w-full h-full object-cover object-center transform group-hover:scale-105 transition-transform duration-700"
                                />
                                <div class="absolute inset-0 bg-gradient-to-t from-black/50 via-black/20 to-transparent"></div>
                            </div>
                            <div class="relative p-8 flex-1 flex flex-col">
                                <div class="flex items-center gap-4 mb-4">
                                    <div class="p-3 bg-brand/10 rounded-xl transform group-hover:scale-110 transition-transform duration-300">
                                        <svg class="w-6 h-6 text-brand" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            {service.icon === 'food-bank' && (
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h18v18H3zM12 8v8m-4-4h8"/>
                                            )}
                                            {/* Add other service icons */}
                                        </svg>
                                    </div>
                                    <h3 class="text-xl font-semibold text-gray-900 leading-tight">
                                        {service.title}
                                    </h3>
                                </div>
                                <p class="text-gray-600/90 leading-relaxed mb-6">
                                    {service.description}
                                </p>
                                <div class="mt-auto">
                                    <span class="inline-flex items-center text-brand font-medium group-hover:text-brand-dark transition-colors">
                                        Learn More
                                        <svg class="w-5 h-5 ml-2 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                                        </svg>
                                    </span>
                                </div>
                            </div>
                        </a>
                    ))}
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="py-24 bg-gradient-to-b from-white to-gray-50">
        <div class="container mx-auto px-6">
            <div class="max-w-7xl mx-auto">
                <div class="space-y-6 mb-16">
                    <div class="inline-flex items-center gap-2 text-brand font-medium">
                        <span class="w-12 h-[2px] bg-brand"></span>
                        <span>Get in Touch</span>
                    </div>
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-900 leading-tight">
                        How Can We Help You?
                    </h2>
                    <p class="text-gray-600 leading-relaxed max-w-2xl">
                        Our team is here to help. For the fastest response, please fill out our assistance request form below. 
                        If you need immediate food assistance, our food pantry is accessible 24/7.
                    </p>
                </div>

                <div class="grid md:grid-cols-2 gap-12 items-center">
                    <!-- Ways to Get Help -->
                    <div class="space-y-8">
                        <div class="bg-white rounded-3xl p-8 shadow-lg border border-gray-100 space-y-8">
                            <div class="space-y-6">
                                <div class="flex items-start gap-4">
                                    <div class="p-3 bg-brand/10 rounded-xl">
                                        <svg class="w-6 h-6 text-brand" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                        </svg>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold text-gray-900 leading-tight">Request Form</h3>
                                        <p class="text-gray-600">Fill out our assistance request form for a response within 2-3 business days</p>
                                    </div>
                                </div>

                                <div class="flex items-start gap-4">
                                    <div class="p-3 bg-brand/10 rounded-xl">
                                        <svg class="w-6 h-6 text-brand" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h18v18H3zM12 8v8m-4-4h8"/>
                                        </svg>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold text-gray-900">24/7 Food Pantry</h3>
                                        <p class="text-gray-600">Access our food pantry anytime, located on the west side of the church</p>
                                    </div>
                                </div>

                                <div class="flex items-start gap-4">
                                    <div class="p-3 bg-brand/10 rounded-xl">
                                        <svg class="w-6 h-6 text-brand" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                        </svg>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold text-gray-900">Emergency Help</h3>
                                        <p class="text-gray-600">For immediate assistance, please visit our food pantry or contact emergency services</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Map -->
                    <div class="relative">
                        <div class="absolute inset-0 bg-brand/10 rounded-3xl transform rotate-3 transition-transform group-hover:rotate-6"></div>
                        <div class="relative bg-white rounded-3xl overflow-hidden shadow-lg">
                            <iframe
                                width="100%"
                                height="500"
                                style="border:0"
                                loading="lazy"
                                allowfullscreen
                                referrerpolicy="no-referrer-when-downgrade"
                                title="Lake Ozark Christian Church Location Map"
                                aria-label="Interactive map showing our church location"
                                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3135.497843479267!2d-92.64396702409653!3d38.19833697188163!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x87c4c5de89ac8075%3A0xd6b3ef02b5ac85cf!2sLake%20Ozark%20Christian%20Church!5e0!3m2!1sen!2sus!4v1737500655692!5m2!1sen!2sus"
                            />
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Request Assistance Form Section -->
    <section id="request-form" class="py-24 bg-gradient-to-b from-white to-gray-50">
        <div class="container mx-auto px-6">
            <div class="max-w-7xl mx-auto">
                <div class="space-y-6 mb-16">
                    <div class="inline-flex items-center gap-2 text-brand font-medium">
                        <span class="w-12 h-[2px] bg-brand"></span>
                        <span>Request Assistance</span>
                    </div>
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-900 leading-tight">
                        Tell Us What You Need
                    </h2>
                    <p class="text-gray-600 leading-relaxed max-w-2xl">
                        Fill out this form and we'll get back to you as soon as possible. For immediate food assistance, 
                        please visit our 24/7 food pantry located at the west side of the church.
                    </p>
                </div>

                <RequestForm />
            </div>
        </div>
    </section>

    <PartnersSection />
</Layout>

<style is:global>
    /* Custom Scrollbar */
    ::-webkit-scrollbar {
        width: 12px;
    }

    ::-webkit-scrollbar-track {
        background: #f1f5f9;
    }

    ::-webkit-scrollbar-thumb {
        background: #94a3b8;
        border-radius: 6px;
        border: 3px solid #f1f5f9;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: #64748b;
    }

    /* Smooth Scroll Behavior */
    html {
        scroll-behavior: smooth;
    }

    /* Animations */
    .animate-fade-in {
        animation: fadeIn 1s ease-out;
    }

    .animate-slide-up {
        animation: slideUp 0.8s ease-out;
    }

    .animate-slide-up-delay-1 {
        animation: slideUp 0.8s ease-out 0.2s both;
    }

    .animate-slide-up-delay-2 {
        animation: slideUp 0.8s ease-out 0.4s both;
    }

    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    @keyframes slideUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
    }
</style>

<script>
    // Smooth scroll for all anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (this: HTMLAnchorElement, e) {
            e.preventDefault();
            const href = this.getAttribute('href');
            if (href) {
                document.querySelector(href)?.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
</script>

<script is:inline>
  document.addEventListener('DOMContentLoaded', () => {
      let currentStep = 1;
      const totalSteps = 4;

      function updateProgress() {
          // Prevent scroll jumping
          const formTop = document.getElementById('multi-step-form').getBoundingClientRect().top;
          const scrollPos = window.scrollY;

          document.querySelectorAll('.form-step').forEach(step => {
              step.classList.add('hidden');
          });
          document.querySelector(`[data-step="${currentStep}"]`).classList.remove('hidden');

          // Update progress indicators
          document.querySelectorAll('.flex.justify-between > div').forEach((indicator, index) => {
              const circle = indicator.querySelector('div');
              if (index + 1 < currentStep) {
                  circle.classList.add('bg-brand', 'border-brand', 'text-white');
              } else if (index + 1 === currentStep) {
                  circle.classList.add('bg-brand', 'border-brand', 'text-white');
              } else {
                  circle.classList.remove('bg-brand', 'border-brand', 'text-white');
              }
          });

          // Maintain scroll position
          window.scrollTo(0, scrollPos);
      }

      window.nextStep = function(step) {
          if (validateStep(step) && step < totalSteps) {
              currentStep = step + 1;
              // Prevent default behavior
              event.preventDefault();
              updateProgress();
          }
      }

      window.prevStep = function(step) {
          if (step > 1) {
              currentStep = step - 1;
              // Prevent default behavior
              event.preventDefault();
              updateProgress();
          }
      }

      function validateStep(step) {
          const currentStepEl = document.querySelector(`[data-step="${step}"]`);
          const inputs = currentStepEl.querySelectorAll('input, select, textarea');
          let isValid = true;

          inputs.forEach(input => {
              if (input.required && !input.value) {
                  isValid = false;
                  input.classList.add('border-red-500');
              } else {
                  input.classList.remove('border-red-500');
              }
          });

          return isValid;
      }

      document.getElementById('multi-step-form').addEventListener('submit', (e) => {
          e.preventDefault();
          if (validateStep(currentStep)) {
              // Submit form to Formspree
              const form = e.target;
              fetch(form.action, {
                  method: form.method,
                  body: new FormData(form),
                  headers: {
                      'Accept': 'application/json'
                  }
              })
              .then(response => {
                  if (response.ok) {
                      // Show success message
                      window.location.href = '/thank-you';
                  } else {
                      // Show error message
                      alert('Oops! There was a problem submitting your form. Please try again.');
                  }
              })
              .catch(error => {
                  console.error('Error:', error);
                  alert('Oops! There was a problem submitting your form. Please try again.');
              });
          }
      });
  });
</script>