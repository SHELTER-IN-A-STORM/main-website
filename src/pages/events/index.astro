---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import { format } from 'date-fns';
import { siteConfig } from '../../config/site';

const allEvents = await getCollection('events');
const upcomingEvents = allEvents.filter((event) => event.data.status === 'upcoming')
  .sort((a, b) => a.data.date.getTime() - b.data.date.getTime());
const pastEvents = allEvents.filter((event) => event.data.status === 'past')
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime());

// Function to truncate description
const truncateDescription = (description: string, maxLength: number = 70) => {
  if (description.length <= maxLength) return description;
  return description.slice(0, maxLength).trim() + '...';
};
---

<Layout title="Events">
    <!-- Hero Section -->
    <section class="relative min-h-screen flex items-center justify-center">
        <div class="absolute inset-0">
            <img 
                src="https://cdn.shelterinastorm.org/images/2025-FallFundraiser-Front-1.png"
                alt="2nd Annual Fall Fundraiser"
                class="w-full h-full object-cover"
            />
            <div class="absolute inset-0 bg-gradient-to-b from-black/60 via-black/40 to-black/60"></div>
        </div>

        <div class="container mx-auto px-6 relative z-10">
            <div class="max-w-4xl mx-auto text-center text-white space-y-8">
                <h1 
                    class="text-5xl md:text-7xl font-bold mb-6"
                    style="text-wrap: balance;"
                >
                    2nd Annual Fall Fundraiser
                </h1>
                <p 
                    class="text-xl md:text-2xl text-gray-200 mb-12 max-w-2xl mx-auto"
                    style="text-wrap: balance;"
                >
                    Join us for dinner, bake-off competition, live music, and silent auction!
                </p>
            </div>
        </div>

        <!-- Scroll Indicator -->
    </section>

    <!-- Impact Numbers Section -->
    <section class="py-16 bg-gray-50">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">Our Impact</h2>
                <p class="text-lg text-gray-600">Making a difference in our community, one person at a time</p>
            </div>
            <div class="grid md:grid-cols-3 gap-8 max-w-4xl mx-auto">
                <div class="text-center">
                    <div class="text-4xl font-bold text-brand mb-2">250+</div>
                    <div class="text-lg text-gray-700">Individuals Helped</div>
                </div>
                <div class="text-center">
                    <div class="text-4xl font-bold text-brand mb-2">10,000+</div>
                    <div class="text-lg text-gray-700">Pantry Items Taken</div>
                </div>
                <div class="text-center">
                    <div class="text-4xl font-bold text-brand mb-2">$70,000</div>
                    <div class="text-lg text-gray-700">Donated and Used</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section class="py-16 bg-white">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">What People Are Saying</h2>
                <p class="text-lg text-gray-600">Real stories from those we've helped</p>
            </div>
            <div class="grid md:grid-cols-2 gap-8 max-w-6xl mx-auto">
                <div class="bg-gray-50 rounded-lg p-6">
                    <div class="text-sm text-gray-500 mb-3">July, 2025</div>
                    <p class="text-gray-700 italic mb-4">
                        "We greatly appreciate the help that was provided to us by 'Shelter in a Storm'. We have been living in our truck waiting on our first pay check. The heat has been crazy, we had no air conditioning, and barely any food other than the free meal we are given at work. 'Shelter in a Storm' has been a blessing, something I would have never expected from somebody, and also the people that donate to this ministry are life savers. When they called me back, their phone number was labeled spam, but something told me to answer, and I am so very glad that I did. God works in mysterious ways. Thank you to this ministry and to all the good people who donate to help people like us. When we are financially stable again, we plan to donate and give back to help others that are in a similar situation."
                    </p>
                    <div class="text-sm font-medium text-gray-900">- V.C.</div>
                </div>
                <div class="bg-gray-50 rounded-lg p-6">
                    <div class="text-sm text-gray-500 mb-3">June, 2025</div>
                    <p class="text-gray-700 italic mb-4">
                        "I want to say a huge thank you to 'Shelter in a Storm'. I fell into a financial bind, and they helped me. I work a full-time job, and I am about to start another job just to make ends meet for me and my 11-year-old son. I will be forever grateful for their assistance. Our Lake community is amazing!"
                    </p>
                    <div class="text-sm font-medium text-gray-900">- A.M.</div>
                </div>
                <div class="bg-gray-50 rounded-lg p-6">
                    <div class="text-sm text-gray-500 mb-3">March, 2025</div>
                    <p class="text-gray-700 italic mb-4">
                        "'Shelter in a Storm' has been a tremendous help for my wife and I. We were met in the midst of our life's storm and given hope again. We are grateful for all of those who support 'Shelter in a Storm'. We pray blessings upon those who donate their time, energy, and tithes towards this wonderful, community-driven organization. Thank you so much!"
                    </p>
                    <div class="text-sm font-medium text-gray-900">- T.B.</div>
                </div>
                <div class="bg-gray-50 rounded-lg p-6">
                    <div class="text-sm text-gray-500 mb-3">February, 2025</div>
                    <p class="text-gray-700 italic mb-4">
                        "I want to thank you so much for all you have done in helping me get a home. I couldn't have done it without you. You are angels sent to me by God and I appreciate all of you from the bottom of my heart. God bless all of you. Thank you."
                    </p>
                    <div class="text-sm font-medium text-gray-900">- O.E.</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Events Content -->
    <div id="events" class="container mx-auto px-4 py-24">
        <h1 class="text-4xl font-bold mb-12">Events</h1>
        
        <!-- Upcoming Events -->
        <section class="mb-16">
          <h2 class="text-2xl font-semibold mb-6">Upcoming Events</h2>
          {upcomingEvents.length > 0 ? (
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
              {upcomingEvents.map((event) => (
                <a href={`/events/${event.slug}`} class="group h-full transition-transform duration-300 hover:-translate-y-1">
                  <div class="bg-white rounded-lg shadow-md overflow-hidden h-full flex flex-col transition-shadow duration-300 hover:shadow-lg">
                    <div class="w-full h-48 flex-shrink-0">
                      <img 
                        src={event.data.image} 
                        alt={event.data.title}
                        class="w-full h-full object-cover"
                      />
                    </div>
                    <div class="p-6 flex-grow flex flex-col">
                      <div class="text-brand font-medium mb-2">
                        {format(event.data.date, 'MMMM d, yyyy')}
                      </div>
                      <h3 class="text-xl font-semibold mb-2 transition-colors duration-300 group-hover:text-brand">
                        {event.data.title}
                      </h3>
                      <p class="text-gray-600 flex-grow">
                        {truncateDescription(event.data.description)}
                      </p>
                    </div>
                  </div>
                </a>
              ))}
            </div>
          ) : (
            <p class="text-gray-600 text-center py-8">No upcoming events scheduled at this time.</p>
          )}
        </section>

        <!-- Past Events -->
        <section>
          <h2 class="text-2xl font-semibold mb-6">Past Events</h2>
          {pastEvents.length > 0 ? (
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
              {pastEvents.map((event) => (
                <a href={`/events/${event.slug}`} class="group h-full transition-all duration-300">
                  <div class="bg-white rounded-lg shadow-md overflow-hidden opacity-75 hover:opacity-100 h-full flex flex-col transition-all duration-300 hover:shadow-lg">
                    <div class="w-full h-48 flex-shrink-0">
                      <img 
                        src={event.data.image} 
                        alt={event.data.title}
                        class="w-full h-full object-cover"
                      />
                    </div>
                    <div class="p-6 flex-grow flex flex-col">
                      <div class="text-brand font-medium mb-2">
                        {format(event.data.date, 'MMMM d, yyyy')}
                      </div>
                      <h3 class="text-xl font-semibold mb-2 transition-colors duration-300 group-hover:text-brand">
                        {event.data.title}
                      </h3>
                      <p class="text-gray-600 flex-grow">
                        {truncateDescription(event.data.description)}
                      </p>
                    </div>
                  </div>
                </a>
              ))}
            </div>
          ) : (
            <p class="text-gray-600 text-center py-8">No past events to display.</p>
          )}
        </section>
    </div>
</Layout> 